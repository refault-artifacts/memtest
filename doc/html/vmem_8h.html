<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Memtest86+: /home/stefan/Documents/Schule/Studium/6._Semester/bsc_thesis/stgloor-memtest/system/vmem.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Memtest86+
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e8522150b400a43ebfdbd1fed060b8e2.html">system</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">vmem.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Provides functions to handle physical memory page mapping into virtual memory.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;<a class="el" href="memsize_8h_source.html">memsize.h</a>&quot;</code><br />
</div>
<p><a href="vmem_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a97c14bf8ba74b78cfdf7ce1ad8e5644e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmem_8h.html#a97c14bf8ba74b78cfdf7ce1ad8e5644e">VM_PINNED_SIZE</a>&#160;&#160;&#160;<a class="el" href="memsize_8h.html#a7cd25262ad2d0f1edf7883e32212f6c6">PAGE_C</a>(2,<a class="el" href="memsize_8h.html#a44172ac633c517cb4c9e278cef36b000">GB</a>)</td></tr>
<tr class="memdesc:a97c14bf8ba74b78cfdf7ce1ad8e5644e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The size of the physical memory region (in pages) that is permanently mapped into virtual memory, starting at virtual address 0.  <a href="vmem_8h.html#a97c14bf8ba74b78cfdf7ce1ad8e5644e">More...</a><br /></td></tr>
<tr class="separator:a97c14bf8ba74b78cfdf7ce1ad8e5644e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f71a36aea912b3b93bf0940c237d84c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmem_8h.html#a8f71a36aea912b3b93bf0940c237d84c">VM_WINDOW_SIZE</a>&#160;&#160;&#160;<a class="el" href="memsize_8h.html#a7cd25262ad2d0f1edf7883e32212f6c6">PAGE_C</a>(1,<a class="el" href="memsize_8h.html#a44172ac633c517cb4c9e278cef36b000">GB</a>)</td></tr>
<tr class="memdesc:a8f71a36aea912b3b93bf0940c237d84c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The size of a physical memory region (in pages) that can be mapped into virtual memory by a call to <a class="el" href="vmem_8h.html#ac828affd54a7bc3fd62d90511d814aaf" title="Maps a VM_WINDOW_SIZE region of physical memory into the upper 2GB of virtual memory.">map_window()</a>.  <a href="vmem_8h.html#a8f71a36aea912b3b93bf0940c237d84c">More...</a><br /></td></tr>
<tr class="separator:a8f71a36aea912b3b93bf0940c237d84c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab0bfb38f833847cd6d5e0245926095c5"><td class="memItemLeft" align="right" valign="top">uintptr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmem_8h.html#ab0bfb38f833847cd6d5e0245926095c5">map_region</a> (uintptr_t base_addr, size_t size, bool only_for_startup)</td></tr>
<tr class="memdesc:ab0bfb38f833847cd6d5e0245926095c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maps a physical memory region into the upper 2GB of virtual memory.  <a href="vmem_8h.html#ab0bfb38f833847cd6d5e0245926095c5">More...</a><br /></td></tr>
<tr class="separator:ab0bfb38f833847cd6d5e0245926095c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac828affd54a7bc3fd62d90511d814aaf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmem_8h.html#ac828affd54a7bc3fd62d90511d814aaf">map_window</a> (uintptr_t start_page)</td></tr>
<tr class="memdesc:ac828affd54a7bc3fd62d90511d814aaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maps a <a class="el" href="vmem_8h.html#a8f71a36aea912b3b93bf0940c237d84c">VM_WINDOW_SIZE</a> region of physical memory into the upper 2GB of virtual memory.  <a href="vmem_8h.html#ac828affd54a7bc3fd62d90511d814aaf">More...</a><br /></td></tr>
<tr class="separator:ac828affd54a7bc3fd62d90511d814aaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0019d8ce328c4735f5a2888a78b85283"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmem_8h.html#a0019d8ce328c4735f5a2888a78b85283">first_word_mapping</a> (uintptr_t page)</td></tr>
<tr class="memdesc:a0019d8ce328c4735f5a2888a78b85283"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a virtual memory pointer to the first word of the specified physical memory page.  <a href="vmem_8h.html#a0019d8ce328c4735f5a2888a78b85283">More...</a><br /></td></tr>
<tr class="separator:a0019d8ce328c4735f5a2888a78b85283"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaebc858fb0ac0bfeb3fc463c97cdcb57"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmem_8h.html#aaebc858fb0ac0bfeb3fc463c97cdcb57">last_word_mapping</a> (uintptr_t page, size_t word_size)</td></tr>
<tr class="memdesc:aaebc858fb0ac0bfeb3fc463c97cdcb57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a virtual memory pointer to the last word of the specified physical memory page.  <a href="vmem_8h.html#aaebc858fb0ac0bfeb3fc463c97cdcb57">More...</a><br /></td></tr>
<tr class="separator:aaebc858fb0ac0bfeb3fc463c97cdcb57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8157e15edc9ec97be592e772ae41f4ce"><td class="memItemLeft" align="right" valign="top">uintptr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmem_8h.html#a8157e15edc9ec97be592e772ae41f4ce">page_of</a> (void *addr)</td></tr>
<tr class="memdesc:a8157e15edc9ec97be592e772ae41f4ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the page number of the physical memory page containing the specified virtual memory address.  <a href="vmem_8h.html#a8157e15edc9ec97be592e772ae41f4ce">More...</a><br /></td></tr>
<tr class="separator:a8157e15edc9ec97be592e772ae41f4ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Provides functions to handle physical memory page mapping into virtual memory. </p>
<p >The startup code sets up the paging tables to give us a 4GB virtual address space, initially identity mapped to the first 4GB of physical memory. We leave the lower 2GB permanently mapped, and use the upper 2GB for mapping the remaining physical memory as required. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a97c14bf8ba74b78cfdf7ce1ad8e5644e" name="a97c14bf8ba74b78cfdf7ce1ad8e5644e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97c14bf8ba74b78cfdf7ce1ad8e5644e">&#9670;&#160;</a></span>VM_PINNED_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_PINNED_SIZE&#160;&#160;&#160;<a class="el" href="memsize_8h.html#a7cd25262ad2d0f1edf7883e32212f6c6">PAGE_C</a>(2,<a class="el" href="memsize_8h.html#a44172ac633c517cb4c9e278cef36b000">GB</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The size of the physical memory region (in pages) that is permanently mapped into virtual memory, starting at virtual address 0. </p>

</div>
</div>
<a id="a8f71a36aea912b3b93bf0940c237d84c" name="a8f71a36aea912b3b93bf0940c237d84c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f71a36aea912b3b93bf0940c237d84c">&#9670;&#160;</a></span>VM_WINDOW_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_WINDOW_SIZE&#160;&#160;&#160;<a class="el" href="memsize_8h.html#a7cd25262ad2d0f1edf7883e32212f6c6">PAGE_C</a>(1,<a class="el" href="memsize_8h.html#a44172ac633c517cb4c9e278cef36b000">GB</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The size of a physical memory region (in pages) that can be mapped into virtual memory by a call to <a class="el" href="vmem_8h.html#ac828affd54a7bc3fd62d90511d814aaf" title="Maps a VM_WINDOW_SIZE region of physical memory into the upper 2GB of virtual memory.">map_window()</a>. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab0bfb38f833847cd6d5e0245926095c5" name="ab0bfb38f833847cd6d5e0245926095c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0bfb38f833847cd6d5e0245926095c5">&#9670;&#160;</a></span>map_region()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uintptr_t map_region </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>base_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>only_for_startup</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maps a physical memory region into the upper 2GB of virtual memory. </p>
<p >The virtual address will have the same alignment within a page as the physical address.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">base_addr</td><td>- the physical byte address of the region. </td></tr>
    <tr><td class="paramname">size</td><td>- the region size in bytes. </td></tr>
    <tr><td class="paramname">only_for_startup</td><td>- if true, the region will remain mapped until the first call to <a class="el" href="vmem_8h.html#ac828affd54a7bc3fd62d90511d814aaf" title="Maps a VM_WINDOW_SIZE region of physical memory into the upper 2GB of virtual memory.">map_window()</a>, otherwise it will be permanently mapped.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, the mapped address in virtual memory, On failure, 0. </dd></dl>

</div>
</div>
<a id="ac828affd54a7bc3fd62d90511d814aaf" name="ac828affd54a7bc3fd62d90511d814aaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac828affd54a7bc3fd62d90511d814aaf">&#9670;&#160;</a></span>map_window()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool map_window </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>start_page</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maps a <a class="el" href="vmem_8h.html#a8f71a36aea912b3b93bf0940c237d84c">VM_WINDOW_SIZE</a> region of physical memory into the upper 2GB of virtual memory. </p>
<p >The physical memory region must be aligned on a <a class="el" href="vmem_8h.html#a8f71a36aea912b3b93bf0940c237d84c">VM_WINDOW_SIZE</a> boundary. The virtual address will be similarly aligned. The region will remain mapped until the next call to <a class="el" href="vmem_8h.html#ac828affd54a7bc3fd62d90511d814aaf" title="Maps a VM_WINDOW_SIZE region of physical memory into the upper 2GB of virtual memory.">map_window()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start_page</td><td>- the physical page number of the region.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, true. On failure, false. </dd></dl>

</div>
</div>
<a id="a0019d8ce328c4735f5a2888a78b85283" name="a0019d8ce328c4735f5a2888a78b85283"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0019d8ce328c4735f5a2888a78b85283">&#9670;&#160;</a></span>first_word_mapping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * first_word_mapping </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>page</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a virtual memory pointer to the first word of the specified physical memory page. </p>
<p >Physical memory pages above <a class="el" href="vmem_8h.html#a97c14bf8ba74b78cfdf7ce1ad8e5644e">VM_PINNED_SIZE</a> must have been mapped by a call to <a class="el" href="vmem_8h.html#ac828affd54a7bc3fd62d90511d814aaf" title="Maps a VM_WINDOW_SIZE region of physical memory into the upper 2GB of virtual memory.">map_window()</a> prior to calling this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">page</td><td>- the physical page number.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the first word of the page. </dd></dl>

</div>
</div>
<a id="aaebc858fb0ac0bfeb3fc463c97cdcb57" name="aaebc858fb0ac0bfeb3fc463c97cdcb57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaebc858fb0ac0bfeb3fc463c97cdcb57">&#9670;&#160;</a></span>last_word_mapping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * last_word_mapping </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>word_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a virtual memory pointer to the last word of the specified physical memory page. </p>
<p >Physical memory pages above <a class="el" href="vmem_8h.html#a97c14bf8ba74b78cfdf7ce1ad8e5644e">VM_PINNED_SIZE</a> must have been mapped by a call to <a class="el" href="vmem_8h.html#ac828affd54a7bc3fd62d90511d814aaf" title="Maps a VM_WINDOW_SIZE region of physical memory into the upper 2GB of virtual memory.">map_window()</a> prior to calling this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">page</td><td>- the physical page number. </td></tr>
    <tr><td class="paramname">word_size</td><td>- the size of a word in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the last word of the page. </dd></dl>

</div>
</div>
<a id="a8157e15edc9ec97be592e772ae41f4ce" name="a8157e15edc9ec97be592e772ae41f4ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8157e15edc9ec97be592e772ae41f4ce">&#9670;&#160;</a></span>page_of()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uintptr_t page_of </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the page number of the physical memory page containing the specified virtual memory address. </p>
<p >The specified address must either be permanently mapped or mapped by a call to <a class="el" href="vmem_8h.html#ac828affd54a7bc3fd62d90511d814aaf" title="Maps a VM_WINDOW_SIZE region of physical memory into the upper 2GB of virtual memory.">map_window()</a> prior to calling this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>- the virtual memory address.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The corresponding physical page number. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
