\hypertarget{serial_8h_source}{}\doxysection{serial.\+h}
\label{serial_8h_source}\index{/home/stefan/Documents/Schule/Studium/6.\_Semester/bsc\_thesis/stgloor-\/memtest/system/serial.h@{/home/stefan/Documents/Schule/Studium/6.\_Semester/bsc\_thesis/stgloor-\/memtest/system/serial.h}}
\mbox{\hyperlink{serial_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef \_SERIAL\_REG\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define \_SERIAL\_REG\_H}\textcolor{comment}{/*}}
\DoxyCodeLine{10 \textcolor{comment}{ * Copyright (C) 2004-\/2022 Sam Demeulemeester.}}
\DoxyCodeLine{11 \textcolor{comment}{ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#define SERIAL\_DEFAULT\_BAUDRATE 115200}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#define SERIAL\_DEFAULT\_BITS     8}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#define SERIAL\_DEFAULT\_PARITY   0}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{preprocessor}{\#define SERIAL\_PORT\_0x3F8   0}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#define SERIAL\_PORT\_0x2F8   1}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define SERIAL\_PORT\_0x3E8   2}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#define SERIAL\_PORT\_0x2E8   3}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{static} \textcolor{keyword}{const} uint16\_t \mbox{\hyperlink{serial_8h_ad30d241b57bc0e4319316d6479d033e1}{serial\_base\_ports}}[] = \{ 0x3f8, 0x2f8, 0x3e8, 0x2e8 \};}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{keyword}{struct }\mbox{\hyperlink{serial_8h_structserial__port}{serial\_port}} \{}
\DoxyCodeLine{25     \textcolor{keywordtype}{bool} \mbox{\hyperlink{serial_8h_a0e833503fe45e6387ba396995c492fb5}{enable}};}
\DoxyCodeLine{26     \textcolor{keywordtype}{bool} \mbox{\hyperlink{serial_8h_acb1b193dbbf6df12e2306e50504fb875}{is\_mmio}};}
\DoxyCodeLine{27     \textcolor{keywordtype}{int} \mbox{\hyperlink{serial_8h_af01e01d42afce4a7d419d9610c1178a2}{parity}};}
\DoxyCodeLine{28     \textcolor{keywordtype}{int} \mbox{\hyperlink{serial_8h_aad682c8079c4c50969ad9ac2b99759bd}{bits}};}
\DoxyCodeLine{29     \textcolor{keywordtype}{int} \mbox{\hyperlink{serial_8h_a7488125f84faef2f3358fe1d7878453c}{baudrate}};}
\DoxyCodeLine{30     \textcolor{keywordtype}{int} \mbox{\hyperlink{serial_8h_a767da7f256347233626735dcded5b2e4}{reg\_width}};}
\DoxyCodeLine{31     \textcolor{keywordtype}{int} \mbox{\hyperlink{serial_8h_a229dc4bea008aa0af3f864cbf78ea216}{refclk}};}
\DoxyCodeLine{32     uintptr\_t \mbox{\hyperlink{serial_8h_ab9b6a645c9ec9c8bd9e82b012d7595e9}{base\_addr}};}
\DoxyCodeLine{33 \};}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 \textcolor{comment}{/*}}
\DoxyCodeLine{36 \textcolor{comment}{ * Definitions for VT100 commands}}
\DoxyCodeLine{37 \textcolor{comment}{ */}}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 \textcolor{preprocessor}{\#define TTY\_CLEAR\_SCREEN    "{}\(\backslash\)x1b[2J"{}}}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 \textcolor{preprocessor}{\#define TTY\_DISABLE\_CURSOR  "{}\(\backslash\)x1b[?25l"{}}}
\DoxyCodeLine{42 }
\DoxyCodeLine{43 \textcolor{preprocessor}{\#define TTY\_NORMAL          "{}\(\backslash\)x1b[0m"{}}}
\DoxyCodeLine{44 \textcolor{preprocessor}{\#define TTY\_BOLD            "{}\(\backslash\)x1b[1m"{}}}
\DoxyCodeLine{45 \textcolor{preprocessor}{\#define TTY\_UNDERLINE       "{}\(\backslash\)x1b[4m"{}}}
\DoxyCodeLine{46 \textcolor{preprocessor}{\#define TTY\_INVERSE         "{}\(\backslash\)x1b[7m"{}}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48 \textcolor{comment}{/*}}
\DoxyCodeLine{49 \textcolor{comment}{ * Definitions for the Base UART Registers}}
\DoxyCodeLine{50 \textcolor{comment}{ */}}
\DoxyCodeLine{51 }
\DoxyCodeLine{52 \textcolor{preprocessor}{\#define UART\_REF\_CLK 1843200}}
\DoxyCodeLine{53 }
\DoxyCodeLine{54 \textcolor{preprocessor}{\#define UART\_RX     0   }\textcolor{comment}{/* In:  Receive buffer (DLAB=0) */}\textcolor{preprocessor}{}}
\DoxyCodeLine{55 \textcolor{preprocessor}{\#define UART\_TX     0   }\textcolor{comment}{/* Out: Transmit buffer (DLAB=0) */}\textcolor{preprocessor}{}}
\DoxyCodeLine{56 \textcolor{preprocessor}{\#define UART\_DLL    0   }\textcolor{comment}{/* Out: Divisor Latch Low (DLAB=1) */}\textcolor{preprocessor}{}}
\DoxyCodeLine{57 \textcolor{preprocessor}{\#define UART\_DLM    1   }\textcolor{comment}{/* Out: Divisor Latch High (DLAB=1) */}\textcolor{preprocessor}{}}
\DoxyCodeLine{58 \textcolor{preprocessor}{\#define UART\_IER    1   }\textcolor{comment}{/* Out: Interrupt Enable Register */}\textcolor{preprocessor}{}}
\DoxyCodeLine{59 \textcolor{preprocessor}{\#define UART\_IIR    2   }\textcolor{comment}{/* In:  Interrupt ID Register */}\textcolor{preprocessor}{}}
\DoxyCodeLine{60 \textcolor{preprocessor}{\#define UART\_FCR    2   }\textcolor{comment}{/* Out: FIFO Control Register */}\textcolor{preprocessor}{}}
\DoxyCodeLine{61 \textcolor{preprocessor}{\#define UART\_EFR    2   }\textcolor{comment}{/* I/O: Extended Features Register */}\textcolor{preprocessor}{}}
\DoxyCodeLine{62     \textcolor{comment}{/* (DLAB=1, 16C660 only) */}}
\DoxyCodeLine{63 \textcolor{preprocessor}{\#define UART\_LCR    3   }\textcolor{comment}{/* Out: Line Control Register */}\textcolor{preprocessor}{}}
\DoxyCodeLine{64 \textcolor{preprocessor}{\#define UART\_MCR    4   }\textcolor{comment}{/* Out: Modem Control Register */}\textcolor{preprocessor}{}}
\DoxyCodeLine{65 \textcolor{preprocessor}{\#define UART\_LSR    5   }\textcolor{comment}{/* In:  Line Status Register */}\textcolor{preprocessor}{}}
\DoxyCodeLine{66 \textcolor{preprocessor}{\#define UART\_MSR    6   }\textcolor{comment}{/* In:  Modem Status Register */}\textcolor{preprocessor}{}}
\DoxyCodeLine{67 \textcolor{preprocessor}{\#define UART\_SCR    7   }\textcolor{comment}{/* I/O: Scratch Register */}\textcolor{preprocessor}{}}
\DoxyCodeLine{68 }
\DoxyCodeLine{69 \textcolor{comment}{/*}}
\DoxyCodeLine{70 \textcolor{comment}{ * Definitions for the Line Control Register}}
\DoxyCodeLine{71 \textcolor{comment}{ */}}
\DoxyCodeLine{72 }
\DoxyCodeLine{73 \textcolor{preprocessor}{\#define UART\_LCR\_DLAB   0x80    }\textcolor{comment}{/* Divisor latch access bit */}\textcolor{preprocessor}{}}
\DoxyCodeLine{74 \textcolor{preprocessor}{\#define UART\_LCR\_SBC    0x40    }\textcolor{comment}{/* Set break control */}\textcolor{preprocessor}{}}
\DoxyCodeLine{75 \textcolor{preprocessor}{\#define UART\_LCR\_SPAR   0x20    }\textcolor{comment}{/* Stick parity (?) */}\textcolor{preprocessor}{}}
\DoxyCodeLine{76 \textcolor{preprocessor}{\#define UART\_LCR\_EPAR   0x10    }\textcolor{comment}{/* Even parity select */}\textcolor{preprocessor}{}}
\DoxyCodeLine{77 \textcolor{preprocessor}{\#define UART\_LCR\_PARITY 0x08    }\textcolor{comment}{/* Parity Enable */}\textcolor{preprocessor}{}}
\DoxyCodeLine{78 \textcolor{preprocessor}{\#define UART\_LCR\_STOP   0x04    }\textcolor{comment}{/* Stop bits: 0=1 stop bit, 1= 2 stop bits */}\textcolor{preprocessor}{}}
\DoxyCodeLine{79 \textcolor{preprocessor}{\#define UART\_LCR\_WLEN5  0x00    }\textcolor{comment}{/* Wordlength: 5 bits */}\textcolor{preprocessor}{}}
\DoxyCodeLine{80 \textcolor{preprocessor}{\#define UART\_LCR\_WLEN6  0x01    }\textcolor{comment}{/* Wordlength: 6 bits */}\textcolor{preprocessor}{}}
\DoxyCodeLine{81 \textcolor{preprocessor}{\#define UART\_LCR\_WLEN7  0x02    }\textcolor{comment}{/* Wordlength: 7 bits */}\textcolor{preprocessor}{}}
\DoxyCodeLine{82 \textcolor{preprocessor}{\#define UART\_LCR\_WLEN8  0x03    }\textcolor{comment}{/* Wordlength: 8 bits */}\textcolor{preprocessor}{}}
\DoxyCodeLine{83 }
\DoxyCodeLine{84 \textcolor{comment}{/*}}
\DoxyCodeLine{85 \textcolor{comment}{ * Definitions for the Line Status Register}}
\DoxyCodeLine{86 \textcolor{comment}{ */}}
\DoxyCodeLine{87 \textcolor{preprocessor}{\#define UART\_LSR\_TEMT   0x40    }\textcolor{comment}{/* Transmitter empty */}\textcolor{preprocessor}{}}
\DoxyCodeLine{88 \textcolor{preprocessor}{\#define UART\_LSR\_THRE   0x20    }\textcolor{comment}{/* Transmit-\/hold-\/register empty */}\textcolor{preprocessor}{}}
\DoxyCodeLine{89 \textcolor{preprocessor}{\#define UART\_LSR\_BI     0x10    }\textcolor{comment}{/* Break interrupt indicator */}\textcolor{preprocessor}{}}
\DoxyCodeLine{90 \textcolor{preprocessor}{\#define UART\_LSR\_FE     0x08    }\textcolor{comment}{/* Frame error indicator */}\textcolor{preprocessor}{}}
\DoxyCodeLine{91 \textcolor{preprocessor}{\#define UART\_LSR\_PE     0x04    }\textcolor{comment}{/* Parity error indicator */}\textcolor{preprocessor}{}}
\DoxyCodeLine{92 \textcolor{preprocessor}{\#define UART\_LSR\_OE     0x02    }\textcolor{comment}{/* Overrun error indicator */}\textcolor{preprocessor}{}}
\DoxyCodeLine{93 \textcolor{preprocessor}{\#define UART\_LSR\_DR     0x01    }\textcolor{comment}{/* Receiver data ready */}\textcolor{preprocessor}{}}
\DoxyCodeLine{94 }
\DoxyCodeLine{95 \textcolor{comment}{/*}}
\DoxyCodeLine{96 \textcolor{comment}{ * Definitions for the Interrupt Identification Register}}
\DoxyCodeLine{97 \textcolor{comment}{ */}}
\DoxyCodeLine{98 \textcolor{preprocessor}{\#define UART\_IIR\_NO\_INT 0x01    }\textcolor{comment}{/* No interrupts pending */}\textcolor{preprocessor}{}}
\DoxyCodeLine{99 \textcolor{preprocessor}{\#define UART\_IIR\_ID     0x06    }\textcolor{comment}{/* Mask for the interrupt ID */}\textcolor{preprocessor}{}}
\DoxyCodeLine{100 }
\DoxyCodeLine{101 \textcolor{preprocessor}{\#define UART\_IIR\_MSI    0x00    }\textcolor{comment}{/* Modem status interrupt */}\textcolor{preprocessor}{}}
\DoxyCodeLine{102 \textcolor{preprocessor}{\#define UART\_IIR\_THRI   0x02    }\textcolor{comment}{/* Transmitter holding register empty */}\textcolor{preprocessor}{}}
\DoxyCodeLine{103 \textcolor{preprocessor}{\#define UART\_IIR\_RDI    0x04    }\textcolor{comment}{/* Receiver data interrupt */}\textcolor{preprocessor}{}}
\DoxyCodeLine{104 \textcolor{preprocessor}{\#define UART\_IIR\_RLSI   0x06    }\textcolor{comment}{/* Receiver line status interrupt */}\textcolor{preprocessor}{}}
\DoxyCodeLine{105 }
\DoxyCodeLine{106 \textcolor{comment}{/*}}
\DoxyCodeLine{107 \textcolor{comment}{ * Definitions for the Interrupt Enable Register}}
\DoxyCodeLine{108 \textcolor{comment}{ */}}
\DoxyCodeLine{109 \textcolor{preprocessor}{\#define UART\_IER\_MS     0x08    }\textcolor{comment}{/* Enable Modem status interrupt */}\textcolor{preprocessor}{}}
\DoxyCodeLine{110 \textcolor{preprocessor}{\#define UART\_IER\_RLSI   0x04    }\textcolor{comment}{/* Enable receiver line status interrupt */}\textcolor{preprocessor}{}}
\DoxyCodeLine{111 \textcolor{preprocessor}{\#define UART\_IER\_THRI   0x02    }\textcolor{comment}{/* Enable Transmitter holding register int. */}\textcolor{preprocessor}{}}
\DoxyCodeLine{112 \textcolor{preprocessor}{\#define UART\_IER\_RDI    0x01    }\textcolor{comment}{/* Enable receiver data interrupt */}\textcolor{preprocessor}{}}
\DoxyCodeLine{113 }
\DoxyCodeLine{114 \textcolor{comment}{/*}}
\DoxyCodeLine{115 \textcolor{comment}{ * Definitions for the Modem Control Register}}
\DoxyCodeLine{116 \textcolor{comment}{ */}}
\DoxyCodeLine{117 \textcolor{preprocessor}{\#define UART\_MCR\_LOOP   0x10    }\textcolor{comment}{/* Enable loopback test mode */}\textcolor{preprocessor}{}}
\DoxyCodeLine{118 \textcolor{preprocessor}{\#define UART\_MCR\_OUT2   0x08    }\textcolor{comment}{/* Out2 complement */}\textcolor{preprocessor}{}}
\DoxyCodeLine{119 \textcolor{preprocessor}{\#define UART\_MCR\_OUT1   0x04    }\textcolor{comment}{/* Out1 complement */}\textcolor{preprocessor}{}}
\DoxyCodeLine{120 \textcolor{preprocessor}{\#define UART\_MCR\_RTS    0x02    }\textcolor{comment}{/* RTS complement */}\textcolor{preprocessor}{}}
\DoxyCodeLine{121 \textcolor{preprocessor}{\#define UART\_MCR\_DTR    0x01    }\textcolor{comment}{/* DTR complement */}\textcolor{preprocessor}{}}
\DoxyCodeLine{122 }
\DoxyCodeLine{123 \textcolor{comment}{/*}}
\DoxyCodeLine{124 \textcolor{comment}{ * Definitions for the Modem Status Register}}
\DoxyCodeLine{125 \textcolor{comment}{ */}}
\DoxyCodeLine{126 \textcolor{preprocessor}{\#define UART\_MSR\_DCD    0x80    }\textcolor{comment}{/* Data Carrier Detect */}\textcolor{preprocessor}{}}
\DoxyCodeLine{127 \textcolor{preprocessor}{\#define UART\_MSR\_RI     0x40    }\textcolor{comment}{/* Ring Indicator */}\textcolor{preprocessor}{}}
\DoxyCodeLine{128 \textcolor{preprocessor}{\#define UART\_MSR\_DSR    0x20    }\textcolor{comment}{/* Data Set Ready */}\textcolor{preprocessor}{}}
\DoxyCodeLine{129 \textcolor{preprocessor}{\#define UART\_MSR\_CTS    0x10    }\textcolor{comment}{/* Clear to Send */}\textcolor{preprocessor}{}}
\DoxyCodeLine{130 \textcolor{preprocessor}{\#define UART\_MSR\_DDCD   0x08    }\textcolor{comment}{/* Delta DCD */}\textcolor{preprocessor}{}}
\DoxyCodeLine{131 \textcolor{preprocessor}{\#define UART\_MSR\_TERI   0x04    }\textcolor{comment}{/* Trailing edge ring indicator */}\textcolor{preprocessor}{}}
\DoxyCodeLine{132 \textcolor{preprocessor}{\#define UART\_MSR\_DDSR   0x02    }\textcolor{comment}{/* Delta DSR */}\textcolor{preprocessor}{}}
\DoxyCodeLine{133 \textcolor{preprocessor}{\#define UART\_MSR\_DCTS   0x01    }\textcolor{comment}{/* Delta CTS */}\textcolor{preprocessor}{}}
\DoxyCodeLine{134 \textcolor{preprocessor}{\#define UART\_MSR\_ANY\_DELTA 0x0F }\textcolor{comment}{/* Any of the delta bits! */}\textcolor{preprocessor}{}}
\DoxyCodeLine{135 }
\DoxyCodeLine{136 \textcolor{comment}{/*}}
\DoxyCodeLine{137 \textcolor{comment}{ * Definitions for the Extended Features Register}}
\DoxyCodeLine{138 \textcolor{comment}{ * (StarTech 16C660 only, when DLAB=1)}}
\DoxyCodeLine{139 \textcolor{comment}{ */}}
\DoxyCodeLine{140 \textcolor{preprocessor}{\#define UART\_EFR\_CTS    0x80    }\textcolor{comment}{/* CTS flow control */}\textcolor{preprocessor}{}}
\DoxyCodeLine{141 \textcolor{preprocessor}{\#define UART\_EFR\_RTS    0x40    }\textcolor{comment}{/* RTS flow control */}\textcolor{preprocessor}{}}
\DoxyCodeLine{142 \textcolor{preprocessor}{\#define UART\_EFR\_SCD    0x20    }\textcolor{comment}{/* Special character detect */}\textcolor{preprocessor}{}}
\DoxyCodeLine{143 \textcolor{preprocessor}{\#define UART\_EFR\_ENI    0x10    }\textcolor{comment}{/* Enhanced Interrupt */}\textcolor{preprocessor}{}}
\DoxyCodeLine{144 }
\DoxyCodeLine{145 \textcolor{preprocessor}{\#define BOTH\_EMPTY (UART\_LSR\_TEMT | UART\_LSR\_THRE)}}
\DoxyCodeLine{146 }
\DoxyCodeLine{147 \textcolor{preprocessor}{\#define tty\_full\_redraw() \(\backslash\)}}
\DoxyCodeLine{148 \textcolor{preprocessor}{    tty\_send\_region(0, 0, 24, 79);}}
\DoxyCodeLine{149 }
\DoxyCodeLine{150 \textcolor{preprocessor}{\#define tty\_partial\_redraw() \(\backslash\)}}
\DoxyCodeLine{151 \textcolor{preprocessor}{    tty\_send\_region(1, 34, 5, 79); \(\backslash\)}}
\DoxyCodeLine{152 \textcolor{preprocessor}{    tty\_send\_region(7, 0, 8, 79); \(\backslash\)}}
\DoxyCodeLine{153 \textcolor{preprocessor}{    if(enable\_temperature) tty\_send\_region(1, 16, 1, 26);}}
\DoxyCodeLine{154 }
\DoxyCodeLine{155 \textcolor{preprocessor}{\#define tty\_error\_redraw() \(\backslash\)}}
\DoxyCodeLine{156 \textcolor{preprocessor}{    tty\_send\_region(10, 0, 23, 79);}}
\DoxyCodeLine{157 }
\DoxyCodeLine{158 \textcolor{preprocessor}{\#define tty\_normal() \(\backslash\)}}
\DoxyCodeLine{159 \textcolor{preprocessor}{    serial\_echo\_print(TTY\_NORMAL);}}
\DoxyCodeLine{160 }
\DoxyCodeLine{161 \textcolor{preprocessor}{\#define tty\_inverse() \(\backslash\)}}
\DoxyCodeLine{162 \textcolor{preprocessor}{    serial\_echo\_print(TTY\_INVERSE);}}
\DoxyCodeLine{163 }
\DoxyCodeLine{164 \textcolor{preprocessor}{\#define tty\_disable\_cursor() \(\backslash\)}}
\DoxyCodeLine{165 \textcolor{preprocessor}{    serial\_echo\_print(TTY\_DISABLE\_CURSOR);}}
\DoxyCodeLine{166 }
\DoxyCodeLine{167 \textcolor{preprocessor}{\#define tty\_clear\_screen() \(\backslash\)}}
\DoxyCodeLine{168 \textcolor{preprocessor}{    serial\_echo\_print(TTY\_CLEAR\_SCREEN);}}
\DoxyCodeLine{169 }
\DoxyCodeLine{170 \textcolor{keywordtype}{void} \mbox{\hyperlink{serial_8h_a0d6679c5a4b8b74b22afc33d06d64eec}{tty\_init}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{171 }
\DoxyCodeLine{172 \textcolor{keywordtype}{void} \mbox{\hyperlink{serial_8h_ae08680a2a18bdaa33c6fe13aecb545e2}{tty\_print}}(\textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} x, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *p);}
\DoxyCodeLine{173 }
\DoxyCodeLine{174 \textcolor{keywordtype}{void} \mbox{\hyperlink{serial_8h_a2e31a4a2cf99b5c4072b147417e47f1d}{tty\_send\_region}}(\textcolor{keywordtype}{int} start\_row, \textcolor{keywordtype}{int} start\_col, \textcolor{keywordtype}{int} end\_row, \textcolor{keywordtype}{int} end\_col);}
\DoxyCodeLine{175 }
\DoxyCodeLine{176 \textcolor{keywordtype}{char} \mbox{\hyperlink{serial_8h_a480bb3995f0777da883f919bd76e1b5e}{tty\_get\_key}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{177 }
\DoxyCodeLine{178 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* \_SERIAL\_REG\_H */}\textcolor{preprocessor}{}}

\end{DoxyCode}
